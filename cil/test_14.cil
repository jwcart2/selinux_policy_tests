;; Bounds testing

(sensitivity s0)
(sensitivityorder (s0))
(level systemlow (s0))
(handleunknown deny)
(mls false)
(sid kernel)
(sidcontext kernel (USER1 ROLE1 TYPE1 (systemlow systemlow)))
(sidorder (kernel ))
(class CLASS1 (PERM1a PERM1b PERM1c ))
(class CLASS2 (PERM2a PERM2b PERM2c ))
(class CLASS3 (PERM3a PERM3b PERM3c ))
(classorder (CLASS1 CLASS2 CLASS3 ))
(role ROLE1)
(roletype ROLE1 TYPE1)

(typeattribute b_a2)
(typeattributeset b_a2 (b_t2 ))
(typeattribute b_a2_c)
(typeattributeset b_a2_c (b_t2_c ))
(typeattribute b_a4)
(typeattributeset b_a4 (b_t4 ))
(typeattribute b_a4_c)
(typeattributeset b_a4_c (b_t4_c ))
(type TYPE1)
(type b_t1)
(type b_t1_c)
(type b_t2)
(type b_t2_c)
(type b_t3)
(type b_t3_c)
(type b_t4)
(type b_t4_c)
(type b_t5a)
(type b_t5a_c)
(type b_t5b)
(type b_t5b_c)
(type b_t7a)
(type b_t7b)
(type b_t7c)
(type b_ta)
(type b_tb)
(type b_tc)
(type b_td)
(typebounds b_t1 b_t1_c)
(typebounds b_t2 b_t2_c)
(typebounds b_t3 b_t3_c)
(typebounds b_t4 b_t4_c)
(typebounds b_t5a b_t5a_c)
(typebounds b_t5b b_t5b_c)
(typebounds b_t7a b_t7b)
(typebounds b_t7b b_t7c)

(user USER1)
(userrole USER1 ROLE1)
(userlevel USER1 systemlow)
(userrange USER1 (systemlow systemlow))
(boolean b_b1 false)
(boolean b_b2 false)
(boolean b_b3 false)
(allow TYPE1 self (CLASS1 (PERM1a)))

;; Comment out for bounds errors
(allow b_t3 self (CLASS1 (PERM1b)))
(allow b_t3 b_ta (CLASS1 (PERM1b)))
(allow b_t3 b_tb (CLASS1 (PERM1b)))
(allow b_t3 b_tc (CLASS1 (PERM1b)))
(allow b_t3 b_td (CLASS1 (PERM1b)))
(allow b_ta b_t3 (CLASS1 (PERM1b)))
(allow b_tb b_t3 (CLASS1 (PERM1b)))
(allow b_tc b_t3 (CLASS1 (PERM1b)))
(allow b_td b_t3 (CLASS1 (PERM1b)))
(allow b_a4 self (CLASS1 (PERM1b)))
(allow b_a4 b_ta (CLASS1 (PERM1b)))
(allow b_a4 b_tb (CLASS1 (PERM1b)))
(allow b_a4 b_tc (CLASS1 (PERM1b)))
(allow b_a4 b_td (CLASS1 (PERM1b)))
(allow b_ta b_a4 (CLASS1 (PERM1b)))
(allow b_tb b_a4 (CLASS1 (PERM1b)))
(allow b_tc b_a4 (CLASS1 (PERM1b)))
(allow b_td b_a4 (CLASS1 (PERM1b)))
(allow b_t5a b_t5b (CLASS1 (PERM1a)))
(allow b_t5a b_t5b (CLASS2 (PERM2b)))
(allow b_t5a b_t5b (CLASS3 (PERM3b)))
;;

(allow b_a2 b_ta (CLASS1 (PERM1a)))
(allow b_a2 b_tc (CLASS1 (PERM1a)))
(allow b_a2 self (CLASS1 (PERM1a)))
(allow b_a2_c b_ta (CLASS1 (PERM1a)))
(allow b_a2_c b_td (CLASS1 (PERM1a)))
(allow b_a2_c self (CLASS1 (PERM1a)))
(allow b_a4 b_ta (CLASS1 (PERM1a)))
(allow b_a4 self (CLASS1 (PERM1a)))
(allow b_a4_c b_ta (CLASS1 (PERM1b)))
(allow b_a4_c b_td (CLASS1 (PERM1b)))
(allow b_a4_c self (CLASS1 (PERM1b)))
(allow b_t1 b_ta (CLASS1 (PERM1a)))
(allow b_t1 b_tc (CLASS1 (PERM1a)))
(allow b_t1 self (CLASS1 (PERM1a)))
(allow b_t1_c b_ta (CLASS1 (PERM1a)))
(allow b_t1_c b_td (CLASS1 (PERM1a)))
(allow b_t1_c self (CLASS1 (PERM1a)))
(allow b_t3 b_ta (CLASS1 (PERM1a)))
(allow b_t3 self (CLASS1 (PERM1a)))
(allow b_t3_c b_ta (CLASS1 (PERM1b)))
(allow b_t3_c b_td (CLASS1 (PERM1b)))
(allow b_t3_c self (CLASS1 (PERM1b)))
(allow b_t5a b_t5b_c (CLASS1 (PERM1a)))
(allow b_t5a_c b_t5b (CLASS1 (PERM1a)))
(allow b_t5a_c b_t5b_c (CLASS1 (PERM1a)))
(allow b_t7a b_ta (CLASS1 (PERM1a PERM1b PERM1c)))
(allow b_t7b b_ta (CLASS1 (PERM1a PERM1b)))
(allow b_t7c b_ta (CLASS1 (PERM1a)))
(allow b_ta b_a2 (CLASS1 (PERM1a)))
(allow b_ta b_a2_c (CLASS1 (PERM1a)))
(allow b_ta b_a4 (CLASS1 (PERM1a)))
(allow b_ta b_a4_c (CLASS1 (PERM1b)))
(allow b_ta b_t1 (CLASS1 (PERM1a)))
(allow b_ta b_t1_c (CLASS1 (PERM1a)))
(allow b_ta b_t3 (CLASS1 (PERM1a)))
(allow b_ta b_t3_c (CLASS1 (PERM1b)))
(allow b_tc b_a2 (CLASS1 (PERM1a)))
(allow b_tc b_t1 (CLASS1 (PERM1a)))
(allow b_td b_a2_c (CLASS1 (PERM1a)))
(allow b_td b_a4_c (CLASS1 (PERM1b)))
(allow b_td b_t1_c (CLASS1 (PERM1a)))
(allow b_td b_t3_c (CLASS1 (PERM1b)))
(booleanif (b_b3)
    (true
        (allow b_td b_t1 (CLASS1 (PERM1a)))
        (allow b_td b_a2 (CLASS1 (PERM1a)))
        (allow b_t1 b_td (CLASS1 (PERM1a)))
        (allow b_a2 b_td (CLASS1 (PERM1a)))
    )
    (false
        (allow b_td b_t3 (CLASS1 (PERM1b)))
        (allow b_td b_t1 (CLASS1 (PERM1a)))
        (allow b_td b_a4 (CLASS1 (PERM1b)))
        (allow b_td b_a2 (CLASS1 (PERM1a)))
        (allow b_t3 b_td (CLASS1 (PERM1b)))
        (allow b_t1 b_td (CLASS1 (PERM1a)))
        (allow b_a4 b_td (CLASS1 (PERM1b)))
        (allow b_a2 b_td (CLASS1 (PERM1a)))
    )
)
(booleanif (b_b2)
    (true
        (allow b_tc b_t3_c (CLASS1 (PERM1b)))
        (allow b_tc b_a4_c (CLASS1 (PERM1b)))
        (allow b_t3_c b_tc (CLASS1 (PERM1b)))
        (allow b_a4_c b_tc (CLASS1 (PERM1b)))
    )
    (false
        (allow b_tc b_t3 (CLASS1 (PERM1b)))
        (allow b_tc b_t1_c (CLASS1 (PERM1a)))
        (allow b_tc b_a4 (CLASS1 (PERM1b)))
        (allow b_tc b_a2_c (CLASS1 (PERM1a)))
        (allow b_t3 b_tc (CLASS1 (PERM1b)))
        (allow b_t1_c b_tc (CLASS1 (PERM1a)))
        (allow b_a4 b_tc (CLASS1 (PERM1b)))
        (allow b_a2_c b_tc (CLASS1 (PERM1a)))
    )
)
(booleanif (b_b1)
    (false
        (allow b_tb b_t3_c (CLASS1 (PERM1b)))
        (allow b_tb b_t1_c (CLASS1 (PERM1a)))
        (allow b_tb b_t1 (CLASS1 (PERM1a)))
        (allow b_tb b_a4_c (CLASS1 (PERM1b)))
        (allow b_tb b_a2_c (CLASS1 (PERM1a)))
        (allow b_tb b_a2 (CLASS1 (PERM1a)))
        (allow b_t3_c b_tb (CLASS1 (PERM1b)))
        (allow b_t1_c b_tb (CLASS1 (PERM1a)))
        (allow b_t1 b_tb (CLASS1 (PERM1a)))
        (allow b_a4_c b_tb (CLASS1 (PERM1b)))
        (allow b_a2_c b_tb (CLASS1 (PERM1a)))
        (allow b_a2 b_tb (CLASS1 (PERM1a)))
    )
)
